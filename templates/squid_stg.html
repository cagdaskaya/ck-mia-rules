{% extends 'base.html' %}

{% block content %}
  
<div class="bg-light container-fluid">
  <table id=squid_stg class="table table-sm table-hover" data-toggle="table">
    <thead>
      <tr>
        <th scope="col">#</th>
        <th scope="col">ACTION</th>
        <th scope="col">SRC</th>
        <th scope="col">DST</th>
        <th scope="col">DST_port</th>
        <th scope="col">Description</th>
      </tr>
    </thead>
    <tbody>
      {% for x, i in enumerate(squid_stg_rules) %}
        <tr>
          <td scope="row">{{ x + 1 }}</td>
          <th scope="row">{{ i['action'] }}</th>
          <td>
            <div id="accordion" role="tablist">
              <div class="card">
                <div class="card-header" role="tab" id="headingSrc{{ x }}">
                  <h5 class="mb-0">
                    <a data-toggle="collapse" href="#collapse{{ x }}" aria-expanded="false" aria-controls="collapse{{ x }}">
                      {% if i['src'] %}
                        {% if i['src']['tags'] %}
                          <span class="font-weight-bold">NOT</span> {{ i['src']['name'] }}
                        {% else %}
                          {{ i['src']['name'] }}
                        {% endif %}
                      {% else %}
                        ANY
                      {% endif %}
                    </a>  
                  </h5>
                </div>
                <div id="collapse{{ x }}" class="collapse" role="tabpanel" aria-labelledby="headingSrc{{ x }}">
                  <div class="card-body">
                    {% if i['src'] %}
                      {% for j in i['src']['vals'] %}
                        {{ " ".join(j) }}<br>
                      {% endfor %}
                    {% endif %}
                  </div>
                </div>
              </div>
            </div>
          </td>
          <td>
            <div id="accordion" role="tablist">
              <div class="card">
                <div class="card-header" role="tab" id="headingDst{{ x }}">
                  <h5 class="mb-0">
                    <a data-toggle="collapse" href="#collapse{{ x }}" aria-expanded="false" aria-controls="collapse{{ x }}">
                      {% if i['dst'] %}
                        {% if i['dst']['tags'] %}
                          <span class="font-weight-bold">NOT</span> {{ i['dst']['name'] }}
                        {% else %}
                          {{ i['dst']['name'] }}
                        {% endif %}
                      {% else %}
                        ANY
                      {% endif %}
                    </a>
                  </h5>
                </div>
                <div id="collapse{{ x }}" class="collapse" role="tabpanel" aria-labelledby="headingDst{{ x }}">
                  <div class="card-body">
                    {% if i['dst'] %}
                      {% for j in i['dst']['vals'] %}
                        {{ " ".join(j) }}<br>
                      {% endfor %}
                    {% endif %}
                  </div>
                </div>
              </div>
            </div>
          </td>
          <td>
            <div id="accordion" role="tablist">
              <div class="card">
                <div class="card-header" role="tab" id="headingDport{{ x }}">
                  <h5 class="mb-0">
                    <a data-toggle="collapse" href="#collapse{{ x }}" aria-expanded="false" aria-controls="collapse{{ x }}">
                      {% if i['dst_port'] %}
                        {% if i['dst_port']['tags'] %}
                          <span class="font-weight-bold">NOT</span> {{ i['dst_port']['name'] }}
                        {% else %}
                          {{ i['dst_port']['name'] }}
                        {% endif %}
                      {% else %}
                        ANY
                      {% endif %}    
                    </a>
                  </h5>
                </div>
                <div id="collapse{{ x }}" class="collapse" role="tabpanel" aria-labelledby="headingDport{{ x }}">
                  <div class="card-body">
                    {% if i['dst_port'] %}
                      {% for j in i['dst_port']['vals'] %}
                        {{ " ".join(j) }}<br>
                      {% endfor %}
                    {% endif %}
                  </div>
                </div>
              </div>
            </div>
          </td>
          <td>
            <div id="accordion" role="tablist">
              <div class="card">
                <div class="card-header" role="tab" id="headingDport{{ x }}">
                  <h5 class="mb-0">
                    <a data-toggle="collapse" href="#collapse{{ x }}" aria-expanded="false" aria-controls="collapse{{ x }}">
                      {% if i['http_method'] %}
                        {% if i['http_method']['tags'] %}
                          <span class="font-weight-bold">NOT</span> {{ i['http_method']['name'] }}
                        {% else %}
                          {{ i['http_method']['name'] }}
                        {% endif %}
                      {% else %}
                        ANY
                      {% endif %}    
                    </a>
                  </h5>
                </div>
                <div id="collapse{{ x }}" class="collapse" role="tabpanel" aria-labelledby="headingDport{{ x }}">
                  <div class="card-body">
                    {% if i['http_method'] %}
                      {% for j in i['http_method']['vals'] %}
                        {{ " ".join(j) }}<br>
                      {% endfor %}
                    {% endif %}
                  </div>
                </div>
              </div>
            </div>
          </td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

{% endblock %}
